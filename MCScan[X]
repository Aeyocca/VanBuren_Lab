11-07-17
Play around with MCScan and MCScanX, just kind of get familiar with them, I think I will follow and online tutorial just to iron everything out first. 
Would like to run a bunch of grass genomes through it to compare / contrast tandem gene duplicates across the grasses, but first:
https://github.com/tanghaibao/jcvi/wiki/MCscan-(Python-version)

Ayoooo fake it til you become it

Installing dependencies for MCScan... I think I will do all this on local first, probably easier than trying to load things onto hpcc for now
"LASTAL. Compile and then move lastal and lastdb on your PATH."
went to link and downloaded last-894 folder, extracted all. Re ran cygwin setup.exe, added under Devel category gcc g++ and gcc core, made sure they were the same version (6.4 something I think), also added make. Needed to add zlib also, just searched for it, found it under lib category I believe. Then was able to run make from last-894 directory, took like a minute, believe it ran.
Next step: move lastal and lastdb on PATH

aeyocca@Larry /cygdrive/c/Users/aeyocca/Downloads/last-894/last-894
$ PATH=/cygdrive/c/Users/aeyocca/Downloads/last-894/last-894/src/lastal
lastal.cc    lastal.exe   lastal.o     lastal.o8    lastal8.exe

aeyocca@Larry /cygdrive/c/Users/aeyocca/Downloads/last-894/last-894
$ PATH=/cygdrive/c/Users/aeyocca/Downloads/last-894/last-894/src/lastal.exe

aeyocca@Larry /cygdrive/c/Users/aeyocca/Downloads/last-894/last-894
$ PATH=/cygdrive/c/Users/aeyocca/Downloads/last-894/last-894/src/lastdb
lastdb.cc    lastdb.exe   lastdb.o     lastdb.o8    lastdb8.exe

aeyocca@Larry /cygdrive/c/Users/aeyocca/Downloads/last-894/last-894
$ PATH=/cygdrive/c/Users/aeyocca/Downloads/last-894/last-894/src/lastdb.exe

Pretty sure I wanted the .exe files, Seems like .cc is the uncomplied file that was compiled using make and .exe I am assuming means its executable

Next: "Optional SCIP. You'll need the executable scip on your PATH. You can also download a copy from here."
Downloaded his file from his github but I dont think it will work, If this all works I think its a good idea to move things out of my downloads folder, might want to start deleting things in there

Lets roll like that scip thing worked.

Follow this tutorial to get python up and running: https://www.davidbaumgold.com/tutorials/set-up-python-windows/
Looks like it works, back to MCScan tutorial
Need to get jcvi package somehow
Got it in /cygdrive/c/Python36/packages/jcvi directory, tried to run and said there was a syntax error. Ill take that as the version of python I'm running doesn't recognize the syntax. The github page was last editied on sept 3 2013, so downloading python 2.7.6 which came out in November 2013, hopefully that works
Installed in /cygdrive/c/Python27 directory... need to remove Python36 paths and replace with Python27

$ PATH=$PATH:/cygdrive/c/Python27
$ PATH=$PATH:/cygdrive/c/Python27/Tools/Scripts
$ python --version
  Python 2.7.6
$ cd /cygdrive/c/Python27
$ mkdir packages
$ cd packages
$ cp -r /cygdrive/c/Python36/packages/jcvi .
$ cd jcvic
$ python -m jcvi.apps.fetch phytozome

Need to find the Bio module, turns out this python version doesn't have pip, hahaha, tried manually installing pip, didn't work
Turns out jcvi was updated about a month ago so go to python version that comes with pip (>=2.7.9)

Lets take 2.7.13
Something not working, try installing python 2.7.14 through cygwin
Add pip 
$ python2 -m ensurepip
$ pip install Biopython
$ python -m jcvi.apps.fetch phytozome

It worked!!!!

Move to /cygdrive/c/Users/aeyocca/Documents/1_MSU/VanBuren.../MSCan directory, copy over jcvi package so it runs
$ python -m jcvi.apps.fetch phytozome Vvinifera,Ppersica

Side notes if I want to move this to hpcc, seems I will need to run >=2.7.9 python version, maybe not any 3 versions though. put jcvi package in same directory where I will run commands from, install Biopython module with pip

11-08-17
Downloading the files in this package used curl in active mode, no idea what that means, that may be the best way to go about things, however it was not working for me, so need to download the files in passive mode by specifying --disable-epsv in the curl command, going to try to fix this in the fetch.py script, pretty hard to find, I think I will just forget about it, will probably save time just manuallly downloading them

Run the python thing, that will spit out the ftp address you need,
$ curl <ftp address> --output <output_name> --disable-epsv
Vvinifera gff3: ftp://ftp.jgi-psf.org/pub/compgen/phytozome/v9.0/Vvinifera/annotation/Vvinifera_145_gene.gff3.gz --output Vvinifera_145_gene.gff3.gz
Vvinifera cds: ftp://ftp.jgi-psf.org/pub/compgen/phytozome/v9.0/Vvinifera/annotation/Vvinifera_145_cds.fa.gz --output Vvinifera_145_cds.fa.gz
Ppersica gff3: ftp://ftp.jgi-psf.org/pub/compgen/phytozome/v9.0/Ppersica/annotation/Ppersica_139_gene.gff3.gz  --output Ppersica_139_gene.gff3.gz
Ppersica cds: ftp://ftp.jgi-psf.org/pub/compgen/phytozome/v9.0/Ppersica/annotation/Ppersica_139_cds.fa.gz --output Ppersica_139_cds.fa.gz

Convert gff to bed: ex python -m jcvi.formats.gff bed --type=mRNA --key=Name Vvinifera_145_gene.gff3.gz -o grape.bed

Next step is pairwise synteny search: need 
$ pip install networkx
$ python -m jcvi.compara.catalog ortholog grape peach

Need to add lastal and lastbd to path
copied lastal.exe and lastdb.exe to /bin directory, added /bin directory to path, then it worked. 
$ pip install scipy
that didn't work, seems I need numpy+mkl wheel file found here: https://www.lfd.uci.edu/~gohlke/pythonlibs/#scipy
but for reasons unknown to me, had to change the file name to numpy-1.13.3+mkl-cp27-none-any.whl for it to work, lets try scipy now that didn't work, lets try file renaming nonsense for scipy, it all downloaded, lets see if it works.
Nope, seems like numpy build didn't work
I think I'm going to cut my losses and make virtual environment on hpcc since clearly something is up with cygwin nonsense
hpcc virtual environment stuff: https://wiki.hpcc.msu.edu/display/hpccdocs/Using+Python+virtualenv+on+the+HPCC
python virtual environment stuff: https://pypi.python.org/pypi/virtualenv

Latest version of python as I'm writing this is 3.6 something I believe, latest for hpcc is 3.5.3 so I think I will roll with that and see if it works, if not, they have some 2.7 versions, the Biopython can only be run on 2.7.2, lets roll with that

Got all these before launching into virtual env. Python is default version, NumPy and SciPy loaded without specifying version:
Currently Loaded Modules:
  1) GNU/4.4.5        5) MATLAB/R2014a    9)  Python/2.7.2      13) MKL/10.3
  2) OpenMPI/1.4.3    6) R/2.15.1         10) Biopython/1.65
  3) TBB/4.1.0        7) Boost/1.47.0     11) SciPy/0.9.0
  4) CMake/2.8.5      8) Stata/15.0.SE    12) NumPy/1.6.1
  
It automatically shifted me to MKL/10.3 from 11 something
Load Biopython too

Took the ?passive=yes thing off of the url in the fetch.py script and ayooo, don't need to manually download files
$ pip install networkx
successful
$ python -m jcvi.compara.catalog ortholog grape peach
lastal and lastdb thing not working


$ virtualenv MCScan
$ source MCScan/bin/activate #launches into virtual environment with those modules loaded previously
Next time can just do source after loading modules instead of virtualenv

Next steps: make mcscan directory (lowercase so don't have to make upper all the time) in 01_VanBuren directory, throw jcvi folder in there, also put lastal/lastdb .exe files (i think that will work) in ~/MCScan/bin/ directory

not recognizing lastal/lastdb, maybe because I built it on cygwin or something, anyway, delete all the lastal files, load unzipped file to hpcc, and use make command.
to compile on hpcc, 
$  make CXXFLAGS=-O3 #add that flag since earlier got the error message cc1plus: error: unrecognized command line option "-std=c++11"

lordy lordy lordy finally looks like that did it..... hmm lastal: I was installed here with multi-threading disabled.
Alright, what I know: compiled lastal with multithreading disabled which is a problem, so I'm going to delete everything and reload the uncompiled version first
Need to compile with a newer compiler, thats the next step, could maybe do that tonight cuz I'm going hommmmeeee.e....

11-09-17
My mission now is to figure out how to compile the lastal and lastdb files so I can execute them. Not able to compile now because of following error message:  unrecognized command line option "-std=c++11"
Looked online, seems it is because g++ is out of date, they say the option -std=c++11 is only available in g++>=4.3 but:
$ g++ --version
g++ (GCC) 4.4.7 20120313 (Red Hat 4.4.7-17)
Copyright (C) 2010 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

They say a wrap around is to specify -std=c++0x which I think is a possible edit to the make file, but make file is binary so can't edit :/
Thought about upgrading g++, but some message came up on hpcc saying carefull. Maybe could try to compile locally, check python bit version on hpcc:
>>> import struct
>>> print struct.calcsize("P") * 8
64

So is local, WHY YOU NO COMPILE CORRECTLY ON LOCAL, SHOULD WORK, maybe get same python version.. shouldn't matter really
Search the error message a little more, not able to edit make file, see if i can run g++ on command line instead
That didn't work, spit out a bunch of file specific error messages like things were defined incorrectly or something, I have the lastal and lastdb files still that were compiled without multithreading, I got the help message by typing lastal on the command line... but says it isn't found when running python script, try throwing lastal / lastdb in some mcscan directories, nope..
Nevermind, wasn't in virtual environment, now in there and able to reproduce the compilesd with multi-threading disabled. Going to try compiling locally and copying and see what happens:
compiling locally didn't work, saw could override -std=c++11 flag by 
$ make CXXFLAGS='-std=c++0x'
spit out some error messages on some scripts, but compiled lastal and lastdb (made the .exe files), see if they work
lastal not found
Son of a gun, lastal and lastdb are 32 bit, but it worked locally, how did it end up 32 bit, nevermind, PE32+ means 64 bit, yea duh
Everywhere online says it should be that the files and the system are not the same bit but it looks like they are, no idea why they cannot read it
Try deleting all files except last ones

Can't figure it out really, just move onto MCScanX, IVE WASTED SO MUCH TIMEEEEEEE. I almost refuse to give up


MCScanX

Download MCScanX from online UGA website, unzip, compile on hpcc using make, follow tutorial for at and vvinifera:
$ ./MCScanX data/at_vv #yes there is a /s (space) there so use MCScanX executable on the preinstalled data/ directory
I think this comes with the tutorial files preloaded, need blast and gff, blast will contain both at and vv, their gff has both together in 1 file
output is a bunch of html files for each organism's chromosome. Also /data/at_vv.collinearity and data/at_vv.tandem
reading the readme to see what I can do next, I guess I want to define tandem duplicates, want to look at tandem duplicates across the grasses, also need to define homologs then to see if grasses share same tandem duplicates. Lets just do at vs vvinifera for now because come preinstalled with blast and gff files
Ah, there is example dot.ctl in downstream_analysis/ directory that explains it, MAKE SURE YOU HAVE TABS AFTER NUMBERS & CHR POSITIONS BEFORE //

[yoccaala@dev-intel14-k20 MCScanX]$ ./duplicate_gene_classifier data/at
Reading BLAST file and pre-processing
Generating BLAST list
54980 matches imported (40847 discarded)
15 pairwise comparisons
211 alignments generated
Type of dup     Code    Number
Singleton       0       5298
Dispersed       1       10460
Proximal        2       1045
Tandem  3       3002
WGD or segmental        4       7364

awesome, have .gene_type file that has geneID \t code
plot duplicate genes across genome? table with # / size of tandem duplicates, histogram of which ones shared? How to display differential retention / loss??

11-14-17
plan moving forward:
- practice tandem duplicate caller on >2 genomes
- Download necessary files for 5 grass species
- tandem duplicate caller on the 5 species
- compare them:
  - Number in each species
  - Which they have in common
  
.bed files have Chrom Start Stop  Name  Score Strand, more possible: https://genome.ucsc.edu/FAQ/FAQformat.html
.gff has Chrom  Start Stop  Start End, nice

Plot tandem duplicates across genome
Download at.gff and at.tandem, all notes now moving to R markdown
